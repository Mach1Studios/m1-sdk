
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Mach1 SDK Reference & Documentation</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;cpp&quot;,&quot;swift&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="cpp">cpp</a>
              <a href="#" data-language-name="swift">swift</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc" class="toc-list-h1">
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="Introduction">Introduction</a>
          </li>
          <li>
            <a href="#overview" class="toc-h1 toc-link" data-title="Overview">Overview</a>
          </li>
          <li>
            <a href="#mach1-internal-angle-standard" class="toc-h1 toc-link" data-title="Mach1 Internal Angle Standard">Mach1 Internal Angle Standard</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#positional-3d-coords" class="toc-h2 toc-link" data-title="Mach1 Internal Angle Standard">Positional 3D Coords</a>
                  </li>
                  <li>
                    <a href="#orientation-euler" class="toc-h2 toc-link" data-title="Mach1 Internal Angle Standard">Orientation Euler</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#mach1encode-api" class="toc-h1 toc-link" data-title="Mach1Encode API">Mach1Encode API</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#installation" class="toc-h2 toc-link" data-title="Mach1Encode API">Installation</a>
                  </li>
                  <li>
                    <a href="#generate-point-results" class="toc-h2 toc-link" data-title="Mach1Encode API">Generate Point Results</a>
                  </li>
                  <li>
                    <a href="#set-input-mode" class="toc-h2 toc-link" data-title="Mach1Encode API">Set Input Mode</a>
                  </li>
                  <li>
                    <a href="#set-output-mode" class="toc-h2 toc-link" data-title="Mach1Encode API">Set Output Mode</a>
                  </li>
                  <li>
                    <a href="#set-rotation" class="toc-h2 toc-link" data-title="Mach1Encode API">Set Rotation</a>
                  </li>
                  <li>
                    <a href="#set-diverge" class="toc-h2 toc-link" data-title="Mach1Encode API">Set Diverge</a>
                  </li>
                  <li>
                    <a href="#set-pitch-height" class="toc-h2 toc-link" data-title="Mach1Encode API">Set Pitch/Height</a>
                  </li>
                  <li>
                    <a href="#set-stereo-rotation" class="toc-h2 toc-link" data-title="Mach1Encode API">Set Stereo Rotation</a>
                  </li>
                  <li>
                    <a href="#set-stereo-spread" class="toc-h2 toc-link" data-title="Mach1Encode API">Set Stereo Spread</a>
                  </li>
                  <li>
                    <a href="#set-auto-orbit" class="toc-h2 toc-link" data-title="Mach1Encode API">Set Auto Orbit</a>
                  </li>
                  <li>
                    <a href="#set-isotropic-periphonic" class="toc-h2 toc-link" data-title="Mach1Encode API">Set Isotropic / Periphonic</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#mach1decode-api" class="toc-h1 toc-link" data-title="Mach1Decode API">Mach1Decode API</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#summary-use" class="toc-h2 toc-link" data-title="Mach1Decode API">Summary Use</a>
                  </li>
                  <li>
                    <a href="#installation" class="toc-h2 toc-link" data-title="Mach1Decode API">Installation</a>
                  </li>
                  <li>
                    <a href="#set-platform-type" class="toc-h2 toc-link" data-title="Mach1Decode API">Set Platform Type</a>
                  </li>
                  <li>
                    <a href="#set-filter-speed" class="toc-h2 toc-link" data-title="Mach1Decode API">Set Filter Speed</a>
                  </li>
                  <li>
                    <a href="#set-decoding-algorithm" class="toc-h2 toc-link" data-title="Mach1Decode API">Set Decoding Algorithm</a>
                  </li>
                  <li>
                    <a href="#begin-buffer" class="toc-h2 toc-link" data-title="Mach1Decode API">Begin Buffer</a>
                  </li>
                  <li>
                    <a href="#end-buffer" class="toc-h2 toc-link" data-title="Mach1Decode API">End Buffer</a>
                  </li>
                  <li>
                    <a href="#decoding" class="toc-h2 toc-link" data-title="Mach1Decode API">Decoding</a>
                  </li>
                  <li>
                    <a href="#example-of-using-decoded-coefficients" class="toc-h2 toc-link" data-title="Mach1Decode API">Example of Using Decoded Coefficients</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#mach1decodepositional-api" class="toc-h1 toc-link" data-title="Mach1DecodePositional API">Mach1DecodePositional API</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#unity-amp-unreal-engine" class="toc-h2 toc-link" data-title="Mach1DecodePositional API">Unity &amp; Unreal Engine</a>
                  </li>
                  <li>
                    <a href="#summary-use" class="toc-h2 toc-link" data-title="Mach1DecodePositional API">Summary Use</a>
                  </li>
                  <li>
                    <a href="#installation" class="toc-h2 toc-link" data-title="Mach1DecodePositional API">Installation</a>
                  </li>
                  <li>
                    <a href="#setup-per-spatial-soundfield-position" class="toc-h2 toc-link" data-title="Mach1DecodePositional API">Setup per Spatial Soundfield Position</a>
                  </li>
                  <li>
                    <a href="#setup-for-advanced-settings" class="toc-h2 toc-link" data-title="Mach1DecodePositional API">Setup for Advanced Settings</a>
                  </li>
                  <li>
                    <a href="#update-per-spatial-soundfield-position" class="toc-h2 toc-link" data-title="Mach1DecodePositional API">Update per Spatial Soundfield Position</a>
                  </li>
                  <li>
                    <a href="#applying-resulting-coefficients" class="toc-h2 toc-link" data-title="Mach1DecodePositional API">Applying Resulting Coefficients</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#mach1transcode-api" class="toc-h1 toc-link" data-title="Mach1Transcode API">Mach1Transcode API</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#usage" class="toc-h2 toc-link" data-title="Mach1Transcode API">Usage</a>
                  </li>
                  <li>
                    <a href="#suggested-metadata-spec-optional" class="toc-h2 toc-link" data-title="Mach1Transcode API">Suggested Metadata Spec [optional]</a>
                  </li>
                  <li>
                    <a href="#formats-supported" class="toc-h2 toc-link" data-title="Mach1Transcode API">Formats Supported</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#common-issues" class="toc-h1 toc-link" data-title="Common Issues">Common Issues</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#orientation-latency-issues" class="toc-h2 toc-link" data-title="Common Issues">Orientation Latency Issues</a>
                  </li>
                  <li>
                    <a href="#orientation-rate-issues-zipper" class="toc-h2 toc-link" data-title="Common Issues">Orientation Rate Issues (Zipper)</a>
                  </li>
                  <li>
                    <a href="#audio-visual-sync-issues" class="toc-h2 toc-link" data-title="Common Issues">Audio/Visual Sync Issues</a>
                  </li>
                  <li>
                    <a href="#spatial-decoding-phase-issues" class="toc-h2 toc-link" data-title="Common Issues">Spatial Decoding Phase Issues</a>
                  </li>
              </ul>
          </li>
      </div>
        <ul class="toc-footer">
            <li><a href='http://www.qdepartment.com/__Mach1/research/'>Research Papers</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='introduction'>Introduction</h1>
<p>M1SDK includes APIs to allow developers to design applications that can encode or pan to a spatial audio render from audio streams and/or playback and decode Mach1Spatial 8channel spatial audio mixes with orientation to decode the correct stereo output sum of the user&#39;s current orientation. Additionally the M1SDK allows users to safely convert surround/spatial audio mixes to and from the Mach1Spatial or Mach1Horizon <strong>VVBP</strong> formats. </p>

<p><strong>VVBP</strong> or <em>Virtual Vector Based Panning</em> is a controlled virtual version of traditional <strong>VBAP</strong> (<em>Vector Based Amplitude Panning</em>) or <strong>SPS</strong> (<em>Spatial PCM Sampling</em>). These formats are designed for simplicity and ease of use &amp; implementation both for the content creators and the developers. The spatial audio mixes are based on only amplitude based coefficients changes for both encoding and decoding, and unlike many other spatial audio approaches, there are no additional signal altering processes (such as room modeling, delays or filters) to create coherent and accurate spatial sound fields and play them back from a first person headtracked perspective. Due to the simplicity of the format and cuboid vector space it relies on, it is also ideal for converting and carrying surround and spatial audio mixes without altering the mix to do so, making it an ideal server side audio middleman container. Bringing controlled post-produced spatial audio into new mediums easily.</p>
<h1 id='overview'>Overview</h1>
<p>The Mach1 Spatial SDK includes three components and libraries: </p>

<ul>
<li><strong><em>Mach1Encode lib:</em></strong>
Encode and process input streams/audio into a Mach1Spatial VVBP format.</li>
<li><strong><em>Mach1Decode lib:</em></strong>
Decode and process a Mach1Spatial VVBP format with device orientation / headtracking to output directional spatial audio.</li>
<li><strong><em>Mach1DecodePositional lib:</em></strong>
Add additional optional decoding layer to decode spatial mixes with 6DOF for positional and orientational decoding. </li>
<li><strong><em>Mach1Transcode lib:</em></strong>
Transcode / convert any audio format (surround/spatial) to or from a Mach1Spatial VVBP format.</li>
</ul>

<p>Mach1Encode and Mach1Decode are supported on OSX 10.7+, Windows 10+, iOS 9.0+ and Android API 19+. Unity 4.0+ and Unreal Engine 4.10+ examples are available and said engines are supported too on the aforementioned platforms. </p>

<p>Mach1Transcode is supported on macOS, linux and Windows, game engine support coming soon.</p>
<h1 id='mach1-internal-angle-standard'>Mach1 Internal Angle Standard</h1><h3 id='positional-3d-coords'>Positional 3D Coords</h3>
<ul>
<li> X+ = strafe right</li>
<li> X- = strafe left</li>
<li> Y+ = up</li>
<li> Y- = down</li>
<li> Z+ = forward</li>
<li> Z- = backward</li>
</ul>
<h3 id='orientation-euler'>Orientation Euler</h3>
<ul>
<li> Yaw[0]+ = rotate right [Range: 0-&gt;360 | -180-&gt;180]</li>
<li> Yaw[0]- = rotate left [Range: 0-&gt;360 | -180-&gt;180]</li>
<li> Pitch[1]+ = rotate up [Range: -90-&gt;90]</li>
<li> Pitch[1]- = rotate down [Range: -90-&gt;90]</li>
<li> Roll[2]+ = tilt right [Range: -90-&gt;90]</li>
<li> Roll[2]- = tilt left [Range: -90-&gt;90]</li>
</ul>
<h1 id='mach1encode-api'>Mach1Encode API</h1>
<p>Mach1Encode allows you to transform input audio streams into the Mach1Spatial VVBP 8 channel format. Included are functions needed for mono, stereo or quad/FOA audio streams. The input streams are referred to as <code>Points</code> in our SDK.</p>

<p>The typical encoding process starts with creating an object of a class Mach1EncodeCore, and setting it up as described below. After that, you&#39;re meant to generate Points by calling generatePointResults() on the object of this class. You&#39;ll get as many points as there are input channels and as many gains in each point as there are output channels. You then copy each input channel to each output channel with the according gain.</p>
<h2 id='installation'>Installation</h2>
<p>Import and link the appropriate target device&#39;s / IDE&#39;s library file. </p>
<h2 id='generate-point-results'>Generate Point Results</h2>
<p>Returns the resulting <code>points</code> coefficients based on selected and calculated input/output configuration.</p>
<pre class="highlight cpp tab-cpp"><code><span class="n">M1EncodeCorePointResults</span> <span class="n">points</span> <span class="o">=</span> <span class="n">m1Encode</span><span class="p">.</span><span class="n">generatePointResults</span><span class="p">();</span>
<span class="c1">// gains are 2d vector of gains which has gain coeff for each input channel
// creating each output channel
</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;&gt;</span> <span class="n">gains</span> <span class="o">=</span> <span class="n">points</span><span class="p">.</span><span class="n">gains</span><span class="p">;</span>
</code></pre><h2 id='set-input-mode'>Set Input Mode</h2>
<p>Sets the number of input streams to be positioned as points.</p>

<ul>
<li>INPUT_MONO</li>
<li>INPUT_STEREO</li>
<li>INPUT_QUAD</li>
<li>INPUT_AFORMAT</li>
<li>INPUT_BFORMAT</li>
</ul>
<pre class="highlight cpp tab-cpp"><code><span class="k">if</span> <span class="p">(</span><span class="n">inputKind</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// Input: MONO
</span>    <span class="n">m1Encode</span><span class="p">.</span><span class="n">inputMode</span> <span class="o">=</span> <span class="n">M1Encode</span><span class="o">::</span><span class="n">INPUT_MONO</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="n">inputKind</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// Input: STERO
</span>    <span class="n">m1Encode</span><span class="p">.</span><span class="n">inputMode</span> <span class="o">=</span> <span class="n">M1Encode</span><span class="o">::</span><span class="n">INPUT_STEREO</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="n">inputKind</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// Input: Quad
</span>    <span class="n">m1Encode</span><span class="p">.</span><span class="n">inputMode</span> <span class="o">=</span> <span class="n">M1Encode</span><span class="o">::</span><span class="n">INPUT_QUAD</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="n">inputKind</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// Input: AFORMAT
</span>    <span class="n">m1Encode</span><span class="p">.</span><span class="n">inputMode</span> <span class="o">=</span> <span class="n">M1Encode</span><span class="o">::</span><span class="n">INPUT_AFORMAT</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="n">inputKind</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// Input: BFORMAT
</span>    <span class="n">m1Encode</span><span class="p">.</span><span class="n">inputMode</span> <span class="o">=</span> <span class="n">M1Encode</span><span class="o">::</span><span class="n">INPUT_BFORMAT</span><span class="p">;</span>
<span class="p">}</span>
</code></pre><h2 id='set-output-mode'>Set Output Mode</h2>
<p>Sets the output spatial format, Mach1Spatial or Mach1Horizon</p>

<ul>
<li>OUTPUT_4CH (Mach1Horizon) [Yaw only]</li>
<li>OUTPUT_8CH (Mach1Spatial) [Yaw, Pitch, Roll]</li>
</ul>
<pre class="highlight cpp tab-cpp"><code><span class="k">if</span> <span class="p">(</span><span class="n">outputKind</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// Output: Quad
</span>    <span class="n">m1Encode</span><span class="p">.</span><span class="n">outputMode</span> <span class="o">=</span> <span class="n">M1Encode</span><span class="o">::</span><span class="n">OUTPUT_4CH</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="n">outputKind</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// Output: 7.1
</span>    <span class="n">m1Encode</span><span class="p">.</span><span class="n">outputMode</span> <span class="o">=</span> <span class="n">M1Encode</span><span class="o">::</span><span class="n">OUTPUT_8CH</span><span class="p">;</span>
<span class="p">}</span>
</code></pre><h2 id='set-rotation'>Set Rotation</h2><pre class="highlight cpp tab-cpp"><code><span class="n">m1Encode</span><span class="p">.</span><span class="n">rotation</span> <span class="o">=</span> <span class="n">rotation</span><span class="p">;</span>
</code></pre>
<p>Rotates the point(s) around the center origin of the vector space.</p>

<blockquote>
<p>UI value range: 0.0 -&gt; 1.0 (0-360)</p>
</blockquote>
<h2 id='set-diverge'>Set Diverge</h2><pre class="highlight cpp tab-cpp"><code><span class="n">m1Encode</span><span class="p">.</span><span class="n">diverge</span> <span class="o">=</span> <span class="n">diverge</span><span class="p">;</span>
</code></pre>
<p>Moves the point(s) to/from center origin of the vector space.</p>

<blockquote>
<p>UI value range: -1.0 -&gt; 1.0</p>
</blockquote>
<h2 id='set-pitch-height'>Set Pitch/Height</h2><pre class="highlight cpp tab-cpp"><code><span class="n">m1Encode</span><span class="p">.</span><span class="n">pitch</span> <span class="o">=</span> <span class="n">pitch</span><span class="p">;</span>
</code></pre>
<p>Moves the point(s) up/down the vector space.</p>

<blockquote>
<p>UI value range: -1.0 -&gt; 1.0</p>
</blockquote>
<h2 id='set-stereo-rotation'>Set Stereo Rotation</h2><pre class="highlight cpp tab-cpp"><code><span class="n">m1Encode</span><span class="p">.</span><span class="n">sRotate</span> <span class="o">=</span> <span class="n">sRotation</span><span class="p">;</span>
</code></pre>
<p>Rotates the two stereo points around the axis of the center point between them.</p>

<blockquote>
<p>UI value range: -180.0 -&gt; 180.0</p>
</blockquote>
<h2 id='set-stereo-spread'>Set Stereo Spread</h2><pre class="highlight cpp tab-cpp"><code><span class="n">m1Encode</span><span class="p">.</span><span class="n">sSpread</span> <span class="o">=</span> <span class="n">sSpread</span><span class="p">;</span>
</code></pre>
<p>Increases or decreases the space between the two stereo points. </p>

<blockquote>
<p>UI value range: 0.0 -&gt; 1.0</p>
</blockquote>
<h2 id='set-auto-orbit'>Set Auto Orbit</h2><pre class="highlight cpp tab-cpp"><code><span class="n">m1Encode</span><span class="p">.</span><span class="n">autoOrbit</span> <span class="o">=</span> <span class="n">autoOrbit</span><span class="p">;</span>
</code></pre>
<p>When active both stereo points rotate in relation to the center point between them so that they always triangulate toward center of the cuboid.</p>

<blockquote>
<p>default value: true</p>
</blockquote>
<h2 id='set-isotropic-periphonic'>Set Isotropic / Periphonic</h2><pre class="highlight cpp tab-cpp"><code><span class="n">m1Encode</span><span class="p">.</span><span class="n">isotropicEncode</span> <span class="o">=</span> <span class="n">enableIsotropicEncode</span><span class="p">;</span>
</code></pre>
<p>When active encoding behavior acts evenly with distribution across all azimuth/rotation angles and all altitude/pitch angles.</p>

<blockquote>
<p>default value: true</p>
</blockquote>
<h1 id='mach1decode-api'>Mach1Decode API</h1>
<p>Mach1Decode supplies the functions needed to playback the Mach1Spatial VVBP 8channels to a stereo stream based on the device&#39;s orientation, this can be used for mobile device windowing or first person based media such as AR/VR/MR without any additional processing effects required.</p>
<h2 id='summary-use'>Summary Use</h2>
<p>The Mach1Decode API is designed to be used the following way:</p>

<p>Setup Step (setup/start):</p>
<pre class="highlight cpp tab-cpp"><code><span class="kt">void</span> <span class="n">setup</span><span class="p">(){</span>
    <span class="n">mach1Decode</span><span class="p">.</span><span class="n">setDecodeAlgoType</span><span class="p">(</span><span class="n">Mach1DecodeAlgoSpatial</span><span class="p">);</span>
    <span class="n">mach1Decode</span><span class="p">.</span><span class="n">setPlatformType</span><span class="p">(</span><span class="n">Mach1PlatformDefault</span><span class="p">);</span>
    <span class="n">mach1Decode</span><span class="p">.</span><span class="n">setFilterSpeed</span><span class="p">(</span><span class="mf">1.0</span><span class="n">f</span><span class="p">);</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="n">loop</span><span class="p">(){</span>
    <span class="n">mach1Decode</span><span class="p">.</span><span class="n">beginBuffer</span><span class="p">();</span>
    <span class="n">mach1Decode</span><span class="p">.</span><span class="n">decode</span><span class="p">(</span><span class="n">deviceYaw</span><span class="p">,</span> <span class="n">devicePitch</span><span class="p">,</span> <span class="n">deviceRoll</span><span class="p">);</span>
    <span class="n">mach1Decode</span><span class="p">.</span><span class="n">endBuffer</span><span class="p">();</span>
<span class="p">}</span>
</code></pre>
<ul>
<li><code>setAlgorithmType</code></li>
<li><code>setAngularSettingsType</code></li>
<li><code>setFilterSpeed</code></li>
</ul>

<p>Audio Loop:</p>

<ul>
<li><code>beginBuffer</code></li>
<li><code>decode</code></li>
<li><code>getCurrentAngle</code> (debug/optional)</li>
<li><code>endBuffer</code></li>
</ul>
<h2 id='installation'>Installation</h2>
<p>Import and link the appropriate target device&#39;s / IDE&#39;s library file. </p>
<h2 id='set-platform-type'>Set Platform Type</h2>
<blockquote>
<p>Set the Angular Type for the target device via the enum
Use the <code>setPlatformType</code> function to set the device&#39;s angle order and convention if applicable:</p>
</blockquote>
<h3 id='preset-types-enum'>Preset Types(enum):</h3>
<ul>
<li><code>Mach1PlatformDefault</code> = 0</li>
<li><code>Mach1PlatformUnity</code> = 1</li>
<li><code>Mach1PlatformUE</code> = 2</li>
<li><code>Mach1PlatformOfEasyCam</code> = 3</li>
<li><code>Mach1PlatformAndroid</code> = 4</li>
<li><code>Mach1PlatformiOSPortrait</code> = 5</li>
<li><code>Mach1PlatformiOSLandscape</code> = 6</li>
</ul>
<pre class="highlight cpp tab-cpp"><code><span class="n">mach1Decode</span><span class="p">.</span><span class="n">setPlatformType</span><span class="p">(</span><span class="n">Mach1PlatformDefault</span><span class="p">);</span>
</code></pre>
<!-- ```android
mach1Decode.setPlatformType(Mach1Decode::Mach1PlatformType::Mach1PlatformAndroid);
``` -->
<pre class="highlight swift tab-swift"><code><span class="n">mach1Decode</span><span class="o">.</span><span class="nf">setPlatformType</span><span class="p">(</span><span class="nv">type</span><span class="p">:</span> <span class="kt">Mach1PlatformType</span><span class="o">.</span><span class="kt">Mach1PlatformiOS</span><span class="p">)</span>
</code></pre><h3 id='angle-order-conventions'>Angle Order Conventions</h3>
<ol>
<li>Order of Yaw, Pitch, Roll (Defined as angle applied first, second and third).</li>
<li>Direction of transform around each pole&#39;s positive movement (left or right rotation).</li>
<li>integer Range before tranform completes 2(PI).</li>
</ol>
<h3 id='euler-angle-orders'>Euler Angle Orders:</h3>
<ul>
<li>(yaw-pitch-roll)</li>
<li>Unity: Left handed x-y-z (pitch-roll-yaw)</li>
<li>Unreal Engine: Right handed z-y-x </li>
</ul>
<h2 id='set-filter-speed'>Set Filter Speed</h2>
<p>Filter speed determines the amount of angle smoothing applied to the orientation angles used for the Mach1DecodeCore class. 1.0 would mean that there is no filtering applied, 0.1 would add a long ramp effect of intermediary angles between each angle sample. It should be noted that you will not have any negative effects with &gt;0.9 but could get some orientation latency when &lt;0.85. The reason you might want angle smoothing is that it might help remove a zipper effect seen on some poorer performing platforms or devices.</p>
<pre class="highlight cpp tab-cpp"><code><span class="kt">float</span> <span class="n">filterSpeed</span> <span class="o">=</span> <span class="mf">1.0</span><span class="n">f</span><span class="p">;</span>

<span class="n">mach1Decode</span><span class="p">.</span><span class="n">setFilterSpeed</span><span class="p">(</span><span class="n">filterSpeed</span><span class="p">);</span>
</code></pre><h2 id='set-decoding-algorithm'>Set Decoding Algorithm</h2>
<p>Use this function to setup and choose the required Mach1 decoding algorithm.</p>
<h3 id='mach1-decoding-algorithm-types'>Mach1 Decoding Algorithm Types:</h3>
<ul>
<li><code>Mach1DecodeAlgoSpatial</code> = 0 (default spatial | 8 channels)</li>
<li><code>Mach1DecodeAlgoAltSpatial</code> = 1 (periphonic spatial | 8 channels)</li>
<li><code>Mach1DecodeAlgoHorizon</code> = 2 (compass / yaw | 4 channels)</li>
<li><code>Mach1DecodeAlgoHorizonPairs</code> = 3 (compass / yaw | 4x stereo mastered pairs)</li>
<li><code>Mach1DecodeAlgoSpatialPairs</code> = 4 (experimental periphonic pairs | 8x stereo mastered pairs)</li>
</ul>
<pre class="highlight cpp tab-cpp"><code><span class="kt">void</span> <span class="n">setDecodeAlgoType</span><span class="p">(</span><span class="n">Mach1DecodeAlgoType</span> <span class="n">newAlgorithmType</span><span class="p">);</span>
</code></pre><h4 id='mach1decodealgospatial'>Mach1DecodeAlgoSpatial</h4>
<p>Mach1Spatial. 8 Channel spatial mix decoding from our cuboid configuration. 
This is the default and recommended decoding utilizing isotropic decoding behavior.</p>
<h4 id='mach1decodealgoaltspatial'>Mach1DecodeAlgoAltSpatial</h4>
<p>Mach1Spatial. 8 Channel spatial mix decoding from our cuboid configuration. 
This is a Periphonic decoding weighted more toward yaw, prone to gimbal lock but can be useful for use cases that only need 2 out of 3 input angle types.</p>
<h4 id='mach1decodealgohorizon'>Mach1DecodeAlgoHorizon</h4>
<p>Mach1Horizon. 4 channel spatial mix decoding for compass / yaw only configurations.
Also able to decode and virtualize a first person perspective of Quad Surround mixes. </p>
<h4 id='mach1decodealgohorizonpairs'>Mach1DecodeAlgoHorizonPairs</h4>
<p>Mach1HorizonPairs. 8 channel spatial mix decoding for compass / yaw only that can support headlocked / non-diegetic stereo elements to be mastered within the mix / 8 channels. Supports and decodes Quad-Binaural mixes.</p>
<h4 id='mach1decodealgospatialpairs'>Mach1DecodeAlgoSpatialPairs</h4>
<p>Mach1SpatialPairs. Periphonic stereo pairs decoding.
This function of decoding is deprecated and only helpful for experimental use cases!</p>
<h2 id='begin-buffer'>Begin Buffer</h2>
<p>Call this function before reading from the Mach1Decode buffer.</p>
<pre class="highlight cpp tab-cpp"><code><span class="n">mach1Decode</span><span class="p">.</span><span class="n">beginBuffer</span><span class="p">();</span>
</code></pre><pre class="highlight swift tab-swift"><code><span class="n">mach1Decode</span><span class="o">.</span><span class="nf">beginBuffer</span><span class="p">()</span>
</code></pre><h2 id='end-buffer'>End Buffer</h2>
<p>Call this function after reading from the Mach1Decode buffer.</p>
<pre class="highlight cpp tab-cpp"><code><span class="n">mach1Decode</span><span class="p">.</span><span class="n">endBuffer</span><span class="p">();</span>
</code></pre><pre class="highlight swift tab-swift"><code><span class="n">mach1Decode</span><span class="o">.</span><span class="nf">endBuffer</span><span class="p">()</span>
</code></pre><h2 id='decoding'>Decoding</h2>
<p>The decode function&#39;s purpose is to give you updated volumes for each input audio channel for each frame in order for spatial effect to manifest itself. There are two versions of this function - one for cases when you might not need very low latency or couldn&#39;t include C/C++ directly, and another version for C/C++ high performance use.</p>

<p>If using on audio thread, high performance version is recommended if possible.</p>

<blockquote>
<p>Default Isotropic Decoding [recommended]: </p>

<p>lower performance version for non audio thread operation or for use in managed languages</p>
</blockquote>
<pre class="highlight cpp tab-cpp"><code><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span> <span class="n">volumes</span> <span class="o">=</span> <span class="n">mach1Decode</span><span class="p">.</span><span class="n">decode</span><span class="p">(</span><span class="kt">float</span> <span class="n">deviceYaw</span><span class="p">,</span> <span class="kt">float</span> <span class="n">devicePitch</span><span class="p">,</span> <span class="kt">float</span> <span class="n">deviceRoll</span><span class="p">);</span>
</code></pre>
<blockquote>
<p>you can get a per sample volumes frame if you specify the buffer size and the current sample index</p>
</blockquote>
<pre class="highlight cpp tab-cpp"><code><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span> <span class="n">volumes</span> <span class="o">=</span> <span class="n">mach1Decode</span><span class="p">.</span><span class="n">decode</span><span class="p">(</span><span class="kt">float</span> <span class="n">deviceYaw</span><span class="p">,</span> <span class="kt">float</span> <span class="n">devicePitch</span><span class="p">,</span> <span class="kt">float</span> <span class="n">deviceRollint</span> <span class="n">bufferSize</span><span class="p">,</span> <span class="kt">int</span> <span class="n">sampleIndex</span><span class="p">);</span>

<span class="c1">// high performance version is meant to be used on the audio thread, it puts the resulting channel volumes
// into a float array instead of allocating a result vector. Notice the pointer to volumeFrame array passed. The array itself has to have a size of 18 floats
</span>
<span class="kt">float</span> <span class="n">volumeFrame</span> <span class="p">[</span><span class="mi">18</span><span class="p">];</span>

<span class="n">mach1Decode</span><span class="p">.</span><span class="n">decode</span><span class="p">(</span><span class="kt">float</span> <span class="n">deviceYaw</span><span class="p">,</span> <span class="kt">float</span> <span class="n">devicePitch</span><span class="p">,</span> <span class="kt">float</span> <span class="n">deviceRoll</span><span class="p">,</span> <span class="kt">float</span> <span class="o">*</span><span class="n">volumeFrame</span><span class="p">,</span> <span class="n">bufferSize</span><span class="p">,</span> <span class="kt">int</span> <span class="n">sampleIndex</span><span class="p">);</span>
</code></pre><h2 id='example-of-using-decoded-coefficients'>Example of Using Decoded Coefficients</h2>
<p>Input orientation angles and return the current sample/buffers coefficients</p>

<blockquote>
<p>Sample based example</p>
</blockquote>
<pre class="highlight cpp tab-cpp"><code><span class="n">volumes</span> <span class="o">=</span> <span class="n">mach1Decode</span><span class="p">.</span><span class="n">decode</span><span class="p">(</span><span class="n">deivceYaw</span><span class="p">,</span> <span class="n">devicePitch</span><span class="p">,</span> <span class="n">deviceRoll</span><span class="p">);</span>

<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">playersLeft</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">setVolume</span><span class="p">(</span><span class="n">volumes</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">overallVolume</span><span class="p">);</span>
    <span class="n">playersRight</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">setVolume</span><span class="p">(</span><span class="n">volumes</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">overallVolume</span><span class="p">);</span>
<span class="p">}</span>
</code></pre><pre class="highlight swift tab-swift"><code><span class="c1">//Send device orientation to m1obj with the preferred algo</span>
<span class="k">let</span> <span class="nv">decodeArray</span><span class="p">:</span> <span class="p">[</span><span class="kt">Float</span><span class="p">]</span>  <span class="o">=</span> <span class="n">m1obj</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">Yaw</span><span class="p">:</span> <span class="kt">Float</span><span class="p">(</span><span class="n">deviceYaw</span><span class="p">),</span> <span class="kt">Pitch</span><span class="p">:</span> <span class="kt">Float</span><span class="p">(</span><span class="n">devicePitch</span><span class="p">),</span> <span class="kt">Roll</span><span class="p">:</span> <span class="kt">Float</span><span class="p">(</span><span class="n">deviceRoll</span><span class="p">))</span>

<span class="c1">//Use each coeff to decode multichannel Mach1 Spatial mix</span>
<span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">0</span><span class="o">...</span><span class="mi">7</span> <span class="p">{</span>

    <span class="n">players</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">volume</span> <span class="o">=</span> <span class="kt">Double</span><span class="p">(</span><span class="n">decodeArray</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span><span class="p">])</span>
    <span class="n">players</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">volume</span> <span class="o">=</span> <span class="kt">Double</span><span class="p">(</span><span class="n">decodeArray</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>

    <span class="nf">print</span><span class="p">(</span><span class="kt">String</span><span class="p">(</span><span class="n">players</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">currentTime</span><span class="p">)</span> <span class="o">+</span> <span class="s">" ; "</span> <span class="o">+</span> <span class="kt">String</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span><span class="p">))</span>
    <span class="nf">print</span><span class="p">(</span><span class="kt">String</span><span class="p">(</span><span class="n">players</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">currentTime</span><span class="p">)</span> <span class="o">+</span> <span class="s">" ; "</span> <span class="o">+</span> <span class="kt">String</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="p">}</span>
</code></pre>
<blockquote>
<p>Buffer based example</p>
</blockquote>
<pre class="highlight cpp tab-cpp"><code><span class="c1">//16 coefficients of spatial, 2 coefficients of headlocked stereo
</span><span class="kt">float</span> <span class="n">volumes</span><span class="p">[</span><span class="mi">18</span><span class="p">];</span>

<span class="n">mach1Decode</span><span class="p">.</span><span class="n">beginBuffer</span><span class="p">();</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">samples</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">mach1Decode</span><span class="p">.</span><span class="n">decode</span><span class="p">(</span><span class="n">Yaw</span><span class="p">,</span> <span class="n">Pitch</span><span class="p">,</span> <span class="n">Roll</span><span class="p">,</span> <span class="n">volumes</span><span class="p">,</span> <span class="n">samples</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>

    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">sndL</span> <span class="o">+=</span> <span class="n">volumes</span><span class="p">[</span><span class="n">j</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">buffer</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">idx</span><span class="p">];</span>
        <span class="n">sndR</span> <span class="o">+=</span> <span class="n">volumes</span><span class="p">[</span><span class="n">j</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">buffer</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">idx</span><span class="p">];</span>
    <span class="p">}</span>

    <span class="n">buf</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="kt">short</span><span class="p">)</span> <span class="p">(</span><span class="n">sndL</span> <span class="o">*</span> <span class="p">(</span><span class="n">SHRT_MAX</span><span class="o">-</span><span class="mi">1</span><span class="p">));</span>
    <span class="n">buf</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="kt">short</span><span class="p">)</span> <span class="p">(</span><span class="n">sndR</span> <span class="o">*</span> <span class="p">(</span><span class="n">SHRT_MAX</span><span class="o">-</span><span class="mi">1</span><span class="p">));</span>
<span class="p">}</span>
<span class="n">mach1Decode</span><span class="p">.</span><span class="n">endBuffer</span><span class="p">();</span>
<span class="n">bufferRead</span> <span class="o">+=</span> <span class="n">samples</span><span class="p">;</span>
</code></pre>
<!-- ## Get Current Time

Use this to get the current time and correlate it to the incoming audio streams, good for debug. 

## Get Current Angle

Use this to get the current angle being processed by Mach1Decode, good for orientation latency checks. 

## Get Log

Use this to get a list of input angles and the associated output coefficients from the used Mach1Decode function. -->
<h1 id='mach1decodepositional-api'>Mach1DecodePositional API</h1>
<p>Mach1DecodePositional allows the 3DOF orientation decoding to decode in a dev environment that supports 6DOF with positional movement. It does this by referencing the user&#39;s device to a location and adding an additional layer of rotations and attenuations to the spatial decoding. </p>
<h2 id='unity-amp-unreal-engine'>Unity &amp; Unreal Engine</h2>
<p>Please view the examples in <code>examples/Unity|UnrealEngine</code> to see deployment of Mach1Spatial mixes with positional rotation and attenuation applied. These fucntions can be viewed from the M1Base class used in both examples and are called by creating a new object in the game engine and attaching Mach1SpatialActor or Mach1SpatialDecode.cs to view the setup for a Mach1 Spatial mix layer. </p>

<aside class="notice">These implementations require the multichannel mixes to be split into multiple-mono mixes. You can use `m1-transcode` or the M1-Transcoder GUI application to achieve this easily.</aside>
<h2 id='summary-use'>Summary Use</h2>
<p>The Mach1DecodePositional API is designed to be added if 6DOF or positional placement of Mach1Decode objects are needed. Once added and used for updating the object&#39;s and referencable device/camera it will calculate the positional and rotational angles and distances and result them via the same useable coefficients that are used for Mach1Decode, as per the following way:</p>
<pre class="highlight cpp tab-cpp"><code><span class="kt">void</span> <span class="n">setup</span><span class="p">(){</span>
    <span class="n">mach1DecodePositional</span><span class="p">.</span><span class="n">setDecodeAlgoType</span><span class="p">(</span><span class="n">Mach1DecodeAlgoSpatial</span><span class="p">);</span>
    <span class="n">mach1DecodePositional</span><span class="p">.</span><span class="n">setPlatformType</span><span class="p">(</span><span class="n">Mach1PlatformDefault</span><span class="p">);</span>
    <span class="n">mach1DecodePositional</span><span class="p">.</span><span class="n">setUseFalloff</span><span class="p">(</span><span class="kt">bool</span> <span class="n">useFalloff</span><span class="p">);</span>
    <span class="n">mach1DecodePositional</span><span class="p">.</span><span class="n">setFalloffCurve</span><span class="p">(</span><span class="kt">float</span> <span class="n">falloffCurve</span><span class="p">);</span>
    <span class="n">mach1DecodePositional</span><span class="p">.</span><span class="n">setUseClosestPointRotationMuteInside</span><span class="p">(</span><span class="kt">bool</span> <span class="n">useClosestPointRotationMuteInside</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">loop</span><span class="p">(){</span>
    <span class="n">mach1DecodePositional</span><span class="p">.</span><span class="n">setCameraPosition</span><span class="p">(</span><span class="n">Mach1Point3D</span> <span class="n">devicePos</span><span class="p">);</span>
    <span class="n">mach1DecodePositional</span><span class="p">.</span><span class="n">setCameraRotation</span><span class="p">(</span><span class="n">Mach1Point3D</span> <span class="n">deviceRot</span><span class="p">);</span>
    <span class="n">mach1DecodePositional</span><span class="p">.</span><span class="n">setDecoderAlgoPosition</span><span class="p">(</span><span class="n">Mach1Point3D</span> <span class="n">objPos</span><span class="p">);</span>
    <span class="n">mach1DecodePositional</span><span class="p">.</span><span class="n">setDecoderAlgoRotation</span><span class="p">(</span><span class="n">Mach1Point3D</span> <span class="n">objRot</span><span class="p">);</span>
    <span class="n">mach1DecodePositional</span><span class="p">.</span><span class="n">setDecoderAlgoScale</span><span class="p">(</span><span class="n">Mach1Point3D</span> <span class="n">objScale</span><span class="p">);</span>

    <span class="n">mach1DecodePositional</span><span class="p">.</span><span class="n">getDist</span><span class="p">();</span>
    <span class="n">mach1DecodePositional</span><span class="p">.</span><span class="n">getVolumesWalls</span><span class="p">(</span><span class="kt">float</span><span class="o">*</span> <span class="n">result</span><span class="p">);</span>
<span class="p">}</span>
</code></pre>
<p>Setup Step (setup/start):</p>

<ul>
<li><code>setDecodeAlgoType</code></li>
<li><code>setPlatformType</code></li>
<li><code>setUseFalloff</code> set distance attenuation for soundfield</li>
<li><code>setFalloffCurve</code> design custom distance attenuation curves</li>
<li><code>setUseClosestPointRotationMuteInside</code> reference rotations use a plane instead of a point, or closest plane of a shape if needed</li>
</ul>

<p>Audio Loop:</p>

<ul>
<li>update device/camera position &amp; rotation (can use Euler or Quat)</li>
<li>update m1obj decode position &amp; rotation (can use Euler or Quat)</li>
<li><code>getDist</code> used for attenuation/falloff results</li>
<li><code>getVolumesWalls</code> resulting coeffs for players</li>
</ul>
<h2 id='installation'>Installation</h2>
<p>Import and link the appropriate target device&#39;s / IDE&#39;s library file. </p>

<p>For Unity: 
 - Import the Custom Asset Package</p>

<p>For Unreal Engine: 
 - Add the Mach1Spatial Plugin to your project</p>

<aside class="notice">Requires libMach1DecodeCAPI for reference to spatial object and orientation decoding</aside>
<h2 id='setup-per-spatial-soundfield-position'>Setup per Spatial Soundfield Position</h2>
<p>The following are functions to aid in how positional distance effects the overall gain of an mach1decode object to any design. The resulting distance calculations can also be used for any external effect if created.</p>
<h3 id='falloff-attenuation'>Falloff/Attenuation</h3><pre class="highlight cpp tab-cpp"><code><span class="kt">void</span> <span class="n">setUseFalloff</span><span class="p">(</span><span class="kt">bool</span> <span class="n">useFalloff</span><span class="p">);</span>
</code></pre>
<p>Boolean turning on/off distance attenuation calculations on that mach1decode object</p>
<h3 id='reference-positional-point-plane-shape'>Reference positional point/plane/shape</h3><pre class="highlight cpp tab-cpp"><code><span class="kt">void</span> <span class="n">setUseClosestPointRotationMuteInside</span><span class="p">(</span><span class="kt">bool</span> <span class="n">useClosestPointRotationMuteInside</span><span class="p">);</span>
</code></pre>
<p>This very long named function can set whether the rotational pivots of a mach1decode soundfield are by referencing the device/camera to a positional point or the closest point of a plane (and further the closest plane of a shape). This allows each mach1decode object to be placed with more design options to prevent soundfield scenes from rotating when not needed.</p>
<h3 id='set-filter-speed'>Set Filter Speed</h3><pre class="highlight cpp tab-cpp"><code><span class="kt">float</span> <span class="n">filterSpeed</span> <span class="o">=</span> <span class="mf">1.0</span><span class="n">f</span><span class="p">;</span>

<span class="n">mach1Decode</span><span class="p">.</span><span class="n">setFilterSpeed</span><span class="p">(</span><span class="n">filterSpeed</span><span class="p">);</span>
</code></pre>
<p>Filter speed determines the amount of angle smoothing applied to the orientation angles used for the Mach1DecodeCore class. 1.0 would mean that there is no filtering applied, 0.1 would add a long ramp effect of intermediary angles between each angle sample. It should be noted that you will not have any negative effects with &gt;0.9 but could get some orientation latency when &lt;0.85. The reason you might want angle smoothing is that it might help remove a zipper effect seen on some poorer performing platforms or devices.</p>
<h2 id='setup-for-advanced-settings'>Setup for Advanced Settings</h2><h3 id='mute-controls'>Mute Controls</h3><pre class="highlight cpp tab-cpp"><code><span class="kt">void</span> <span class="n">setMuteWhenOutsideObject</span><span class="p">(</span><span class="kt">bool</span> <span class="n">muteWhenOutsideObject</span><span class="p">);</span>
</code></pre>
<p>Similar to the <code>setUseClosestPointRotationMuteInside</code> these functions give further control over placing a soundfield positionally and determining when it should/shouldn&#39;t output results.</p>
<pre class="highlight cpp tab-cpp"><code><span class="kt">void</span> <span class="n">setMuteWhenInsideObject</span><span class="p">(</span><span class="kt">bool</span> <span class="n">muteWhenInsideObject</span><span class="p">);</span>
</code></pre>
<p>Mute mach1decode object (all coefficifient results becomes 0) when outside the positional reference shape/point</p>

<p>Mute mach1decode object (all coefficifient results becomes 0) when inside the positional reference shape/point</p>
<h3 id='manipulate-input-angles-for-positional-rotations'>Manipulate input angles for positional rotations</h3><pre class="highlight cpp tab-cpp"><code><span class="kt">void</span> <span class="n">setUseYawForRotation</span><span class="p">(</span><span class="kt">bool</span> <span class="n">useYawForRotation</span><span class="p">);</span>
</code></pre>
<p>Ignore Yaw angle rotation results from pivoting positionally</p>
<pre class="highlight cpp tab-cpp"><code><span class="kt">void</span> <span class="n">setUsePitchForRotation</span><span class="p">(</span><span class="kt">bool</span> <span class="n">usePitchForRotation</span><span class="p">);</span>
</code></pre>
<p>Ignore Pitch angle rotation results from pivoting positionally</p>
<pre class="highlight cpp tab-cpp"><code><span class="kt">void</span> <span class="n">setUseRollForRotation</span><span class="p">(</span><span class="kt">bool</span> <span class="n">useRollForRotation</span><span class="p">);</span>
</code></pre>
<p>Ignore Roll angle rotation results from pivoting positionally</p>

<!-- ### Experimental: BlendMode
This is a feature for combining two mach1decode spatial mixes to become blended for inside reference shape only, attenuation between both decode mixes are relative to each other and based on a center to exterior planes (walls) relationship.
```cpp
void setUseBlendMode(bool useBlendMode);
```
Enable this experimental mode

```cpp
void setIgnoreTopBottom(bool ignoreTopBottom);
```
Ignore height for blendmode during calculations

```cpp
void setFalloffCurveBlendMode(float falloffCurveBlendMode);
```
Set the custom curve for the relationship between the center to the exterior planes.  -->
<h2 id='update-per-spatial-soundfield-position'>Update per Spatial Soundfield Position</h2>
<p>Updatable variables for each mach1decode object. These are also able to be set once if needed.</p>
<pre class="highlight cpp tab-cpp"><code><span class="kt">void</span> <span class="n">setCameraPosition</span><span class="p">(</span><span class="n">Mach1Point3DCore</span><span class="o">*</span> <span class="n">pos</span><span class="p">);</span>
</code></pre>
<p>Updates the device/camera&#39;s position in desired x,y,z space</p>
<pre class="highlight cpp tab-cpp"><code><span class="kt">void</span> <span class="n">setCameraRotation</span><span class="p">(</span><span class="n">Mach1Point3DCore</span><span class="o">*</span> <span class="n">euler</span><span class="p">);</span>
</code></pre>
<p>Updates the device/camera&#39;s orientation with Euler angles (yaw, pitch, roll)</p>
<pre class="highlight cpp tab-cpp"><code><span class="kt">void</span> <span class="n">setCameraRotationQuat</span><span class="p">(</span><span class="n">Mach1Point4DCore</span><span class="o">*</span> <span class="n">quat</span><span class="p">);</span>
</code></pre>
<p>Updates the device/camera&#39;s orientation with Quaternion</p>
<pre class="highlight cpp tab-cpp"><code><span class="kt">void</span> <span class="n">setDecoderAlgoPosition</span><span class="p">(</span><span class="n">Mach1Point3DCore</span><span class="o">*</span> <span class="n">pos</span><span class="p">);</span>
</code></pre>
<p>Updates the decode object&#39;s position in desired x,y,z space</p>
<pre class="highlight cpp tab-cpp"><code><span class="kt">void</span> <span class="n">setDecoderAlgoRotation</span><span class="p">(</span><span class="n">Mach1Point3DCore</span><span class="o">*</span> <span class="n">euler</span><span class="p">);</span>
</code></pre>
<p>Updates the decode object&#39;s orientation with Euler angles (yaw, pitch, roll)</p>
<pre class="highlight cpp tab-cpp"><code><span class="kt">void</span> <span class="n">setDecoderAlgoRotationQuat</span><span class="p">(</span><span class="n">Mach1Point4DCore</span><span class="o">*</span> <span class="n">quat</span><span class="p">);</span>
</code></pre>
<p>Updates the decode object&#39;s orientation with Quaternion</p>
<pre class="highlight cpp tab-cpp"><code><span class="kt">void</span> <span class="n">setDecoderAlgoScale</span><span class="p">(</span><span class="n">Mach1Point3DCore</span><span class="o">*</span> <span class="n">scale</span><span class="p">);</span>
</code></pre>
<p>Updates the decode object&#39;s scale in desired x,y,z space</p>
<h2 id='applying-resulting-coefficients'>Applying Resulting Coefficients</h2><pre class="highlight cpp tab-cpp"><code><span class="kt">void</span> <span class="n">evaluatePositionResults</span><span class="p">();</span>
</code></pre>
<p>Calculate!</p>
<pre class="highlight cpp tab-cpp"><code><span class="kt">void</span> <span class="n">getVolumesWalls</span><span class="p">(</span><span class="kt">float</span> <span class="o">*</span><span class="n">result</span><span class="p">);</span>
</code></pre>
<p>Get coefficient results for applying to mach1decode object for rotational and positional, replaces the results from: <code>mach1Decode.decode</code></p>
<h3 id='return-relative-comparisons'>Return Relative Comparisons</h3><pre class="highlight cpp tab-cpp"><code><span class="kt">float</span> <span class="n">getDist</span><span class="p">();</span>
</code></pre>
<p>Get normalized distance between mach1decode object and device/camera
<code>cpp
Mach1Point3DCore getCurrentAngle();
</code>
<code>cpp
Mach1Point3DCore getVolumeRotation();
</code></p>

<!-- ### Experimental: BlendMode
```cpp
void getVolumesRoom(float *result);
```
Get coeff results for the center of "Blend Mode". Very experimental! -->
<h3 id='update-falloff-attenuation'>Update Falloff/Attenuation</h3><pre class="highlight cpp tab-cpp"><code><span class="kt">void</span> <span class="n">setFalloffCurve</span><span class="p">(</span><span class="kt">float</span> <span class="n">falloffCurve</span><span class="p">);</span>
</code></pre>
<p>Set a resulting float of that curve to the current buffer</p>
<h1 id='mach1transcode-api'>Mach1Transcode API</h1>
<p>Mach1Transcode includes functions for use cases that utilizing Mach1Spatial&#39;s agnostic abilities and allows 1:1 VBAP style conversions from any surround or spatial audio format and to any other surround or spatial audio format. This is very helpful for apps that have certain input requirements but different output requirements based on whether the app is launched for VR/AR/MR or just mobile use without completely redesigning the application&#39;s structure for audio. This is also a recommended method of carrying one master spatial audio container and at endpoints converting it as needed without adverse signal altering effects seen in other spatial audio formats. </p>
<h2 id='usage'>Usage</h2>
<p>Rapidly offline render to and from Mach1 formats.</p>

<blockquote>
<p>Example in command line for converting Mach1Spatial mix to First Order ambisonics: ACNSN3D</p>
</blockquote>
<pre class="highlight plaintext"><code>m1-transcode fmtconv -in-file /path/to/file.wav -in-fmt M1Spatial -out-fmt ACNSN3D -out-file /path/to/output.wav -out-file-chans 0
</code></pre>
<blockquote>
<p>Example in command line for converting 7.1 film mix to Mach1Spatial</p>
</blockquote>
<pre class="highlight plaintext"><code>m1-transcode fmtconv -in-file /path/to/file.wav -in-fmt SevenOnePT_Cinema -out-fmt Mach1Spatial -out-file /path/to/output.wav
</code></pre>
<blockquote>
<p>Example in command line for converting Mach1Spatial to Mach1HorizonPairs (quad-binaural compliant)</p>
</blockquote>
<pre class="highlight plaintext"><code>m1-transcode fmtconv -in-file /path/to/file.wav -in-fmt M1Spatial -out-fmt Mach1HorizonPairs -out-file /path/to/output.wav -out-file-chans 2
</code></pre><h2 id='suggested-metadata-spec-optional'>Suggested Metadata Spec [optional]</h2>
<blockquote>
<p>Mach1 Spatial = <code>mach1spatial-8</code></p>

<p>Mach1 Spatial+ = <code>mach1spatial-12</code></p>

<p>Mach1 Spatial++ = <code>mach1spatial-16</code></p>

<p>Mach1 StSP = <code>mach1stsp-2</code></p>

<p>Mach1 Horizon = <code>mach1horizon-4</code></p>

<p>Mach1 Horizon Pairs = <code>mach1horizon-8</code></p>
</blockquote>

<p>Metadata is not required for decoding any Mach1 VVBP format, and often it is not recommended to rely on auto-detection methods but instead rely on UI/UX for user input upon uploading a Mach1 multichannel audio file for safest handling. This is due to their being several possible 8 channel formats and unless there are proper methods to filter and detect and handle each one, user input will be a safer option. There are many oppurtunities for transcoding or splitting a multichannel audio file all of which could undo metadata or apply false-positive metadata due to the many audio engines not built to handle multichannel solutions safely. </p>

<p>If autodetection is still required, use the following suggested specifications which will be applied to mixes that run out of M1-Transcoder and soon m1-transcode directly:</p>

<aside class="notice">Implemented via ICMT/comment of common codec tags</aside>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight plaintext"><code>  Metadata:
    comment         : mach1spatial-8
</code></pre><h2 id='formats-supported'>Formats Supported</h2><h3 id='mach1-formats'>Mach1 Formats</h3>
<ul>
<li>M1Horizon (Mach1 Horizon / Quad) - L R Ls Rs</li>
<li>M1Horizon+S (Mach1 Horizon / Quad) - L R Ls Rs StereoL StereoR</li>
<li>M1HorizonPairs (Mach1 Horizon / Quad-Binaural) - FrontPair, LeftPair, RearPair, RightPair</li>
<li>M1Spatial (Mach1Spatial) - Upper L R Ls Rs, Lower L R Ls Rs</li>
<li>M1Spatial+S (Mach1Spatial) - Upper L R Ls Rs, Lower L R Ls Rs, StereoL StereoR</li>
<li>M1SpatialPairs (Mach1Spatial Pairs) - Upper front, left, rear, right, pairs, then lower same</li>
<li>M1SpatialFaces - Encoder for mono to cube faces</li>
</ul>
<h3 id='traditional-surround-formats'>Traditional / Surround Formats</h3>
<ul>
<li>Stereo - L &amp; R spatialized</li>
<li>Stereo_Cinema - L &amp; R spatialized, forward focus</li>
<li>LCR - L &amp; R spatialized with C mono</li>
<li>FiveOh - L C R Ls Rs</li>
<li>FiveOneFilm (Pro Tools default) - L C R Ls Rs LFE</li>
<li>FiveOneFilm_Cinema (Pro Tools default) - L C R Ls Rs LFE, forward focus</li>
<li>FiveOneSmpte (SMPTE/ITU for Dolby Digital - L R C LFE Ls Rs</li>
<li>FiveOneDts (DTS) - L R Ls Rs C LFE</li>
<li>SevenOnePT (Pro Tools default) - L C R Lss Rss Lsr Rsr LFE</li>
<li>SevenOnePT_Cinema (Pro Tools default) - L C R Lss Rss Lsr Rsr LFE, forward focus</li>
<li>SevenZero_Cinema - L C R Lss Rss Lsr Rsr, forward focus</li>
<li>SevenOneSDDS (Sony SDDS) - L Lc C Rc R Ls Rs LFE</li>
<li>SevenZeroSDDS (Sony SDDS) - L Lc C Rc R Ls Rs</li>
<li>FiveOneTwo - L C R Lss Rss Lsr Rsr FLts FRts BLts BRts</li>
<li>FiveZeroTwo - L C R Lss Rss Lsr Rsr FLts FRts BLts BRts</li>
<li>FiveOneFour - L C R Lss Rss Lsr Rsr FLts FRts BLts BRts</li>
<li>FiveZeroFour - L C R Lss Rss Lsr Rsr FLts FRts BLts BRts</li>
<li>SevenOneTwo - L C R Lss Rss Lsr Rsr LFE Lts Rts</li>
<li>SevenZeroTwo - L C R Lss Rss Lsr Rsr Lts Rts</li>
<li>SevenOneFour - L C R Lss Rss Lsr Rsr LFE FLts FRts BLts BRts</li>
<li>SevenZeroFour - L C R Lss Rss Lsr Rsr FLts FRts BLts BRts</li>
<li>NineOne </li>
<li>NineZero</li>
</ul>

<p><aside class="notice">Additional formats available upon request.</aside></p>
<h3 id='ambisonic-formats-special-thanks-to-a-href-http-http-www-vvaudio-com-vvaudio-a'>Ambisonic Formats (special thanks to <a href="http://http//www.vvaudio.com/">VVAudio</a> ):</h3>
<ul>
<li>ACNSN3D - 1st order B-format, ACN order and SN3D weighting</li>
<li>FuMa - 1st order B-format, Furse-Malham order and weighting</li>
<li>ACNSN3DO2A - 2nd order B-format, AmbiX ACN order and SN3D weighting</li>
<li>FuMaO2A - 2nd order B-format, Furse-Malham order and weighting</li>
<li>TBE - Facebook360 Hybrid 2nd order</li>
<li>ACNSN3DO3A - 3rd order B-format, AmbiX ACN order and SN3D weighting</li>
<li>FuMaO3A - 3rd order B-format, Furse-Malham order and weighting</li>
</ul>
<h1 id='common-issues'>Common Issues</h1>
<p>The following is a list of common heard issues during implementation and include audio tools to help find these issues as well as basic descriptions of their behavior and how they can be avoided.</p>
<h3 id='orientation-latency-issues'>Orientation Latency Issues</h3>
<aside class="notice">Orientation Latency is usually the biggest concern in the current climate of devices that need some sort of headtracking or window tracking. This is an issue for visuals but just as much for audio as well, if the angles inputted into the Mach1Decode functions are late then so are the returned coefficients which leads to the user losing immersion and effect.
</aside>
<h3 id='orientation-rate-issues-zipper'>Orientation Rate Issues (Zipper)</h3>
<aside class="notice">
If the rate of angles sending to the app layer with Mach1Decode integrated is too slow, this can cause some audible distortion / clicking issues added to the mix. The effect will sound like a zipper as you headtrack faster and faster. This is due to the difference of the returned coefficients being too large from result to result, causing the gain change applied to be too large and creating a "jump". We have included ways to filter the input angles into our functions however this is a band-aid to the issue if your target device has this issue. The idea is to filter and delay the inputting angles adding more intermidiary angles between each "jump" but at the cost of Orientation Latency (see above).
</aside>
<pre class="highlight cpp tab-cpp"><code>
</code></pre><h3 id='audio-visual-sync-issues'>Audio/Visual Sync Issues</h3>
<aside class="notice">
It is important to ensure sync between a visual element in your project / application and the spatial audio mix. Ensure they are managed by the same function receiving the same call.
</aside>
<h3 id='spatial-decoding-phase-issues'>Spatial Decoding Phase Issues</h3>
<aside class="notice">
If you have your spatial audio streams coming from different audio managers that do not have sync between them you will start hearing strange channel phasing issues while you track your head orientation or device orientation. Eliminate these by ensuring your audio is called at the same time and managed properly. 
</aside>
<p><em>Last updated: 2018-May-16</em></p>

<p>© Copyright 2017-2018, Mach1. All rights reserved.</p>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="cpp">cpp</a>
                <a href="#" data-language-name="swift">swift</a>
          </div>
      </div>
    </div>
  </body>
</html>
