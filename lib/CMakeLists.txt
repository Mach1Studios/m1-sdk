cmake_minimum_required(VERSION 2.8.8)
project(Mach1Library)
set(Mach1Library_VERSION_MAJOR 1)
set(Mach1Library_VERSION_MINOR 0)
set(Mach1Library_VERSION_PATCH 0)
set(Mach1Library_VERSION_TWEAK 3)

if(IOS)
	add_library(Mach1DecodeCAPI "./Mach1DecodeCAPI.cpp" "./Mach1DecodeCore.cpp" "./Mach1Point3DCore.cpp" "./Mach1Point4DCore.cpp")
	add_library(Mach1DecodePositionalCAPI  "./Mach1DecodePositionalCAPI.cpp" "./Mach1DecodeCore.cpp" "./Mach1DecodePositionalCore.cpp" "./Mach1Point3DCore.cpp" "./Mach1Point4DCore.cpp")
	target_include_directories(Mach1DecodePositionalCAPI PRIVATE "./include")
	add_library(Mach1EncodeCAPI "./Mach1EncodeCAPI.cpp" "./Mach1EncodeCore.cpp")
elseif(APPLE)
	# static lib
	add_library(Mach1DecodeCAPI_Static "./Mach1DecodeCAPI.cpp" "./Mach1DecodeCore.cpp" "./Mach1Point3DCore.cpp" "./Mach1Point4DCore.cpp")
	add_library(Mach1DecodePositionalCAPI_Static "./Mach1DecodePositionalCAPI.cpp" "./Mach1DecodeCAPI.cpp" "./Mach1DecodeCore.cpp" "./Mach1DecodePositionalCore.cpp" "./Mach1Point3DCore.cpp" "./Mach1Point4DCore.cpp")
	target_include_directories(Mach1DecodePositionalCAPI_Static PRIVATE "./include")
	add_library(Mach1EncodeCAPI_Static "./Mach1EncodeCAPI.cpp" "./Mach1EncodeCore.cpp")
	set_target_properties(Mach1DecodeCAPI_Static PROPERTIES OUTPUT_NAME "Mach1DecodeCAPI")
	set_target_properties(Mach1EncodeCAPI_Static PROPERTIES OUTPUT_NAME "Mach1EncodeCAPI")
	set_target_properties(Mach1DecodePositionalCAPI_Static PROPERTIES OUTPUT_NAME "Mach1DecodePositionalCAPI")
	install(TARGETS Mach1DecodeCAPI_Static DESTINATION libSTATIC)
	install(TARGETS Mach1EncodeCAPI_Static DESTINATION libSTATIC)
	install(TARGETS Mach1DecodePositionalCAPI_Static DESTINATION libSTATIC)
	# dynamic lib
	add_library(Mach1DecodeCAPI SHARED "./Mach1DecodeCAPI.cpp" "./Mach1DecodeCore.cpp" "./Mach1Point3DCore.cpp" "./Mach1Point4DCore.cpp")
	add_library(Mach1DecodePositionalCAPI SHARED "./Mach1DecodePositionalCAPI.cpp" "./Mach1DecodeCAPI.cpp" "./Mach1DecodeCore.cpp" "./Mach1DecodePositionalCore.cpp" "./Mach1Point3DCore.cpp" "./Mach1Point4DCore.cpp")
	target_include_directories(Mach1DecodePositionalCAPI PRIVATE "./include")
	add_library(Mach1EncodeCAPI SHARED "./Mach1EncodeCAPI.cpp" "./Mach1EncodeCore.cpp")
	install(TARGETS Mach1DecodeCAPI DESTINATION lib)
	install(TARGETS Mach1EncodeCAPI DESTINATION lib)
	install(TARGETS Mach1DecodePositionalCAPI DESTINATION lib)
	# bundles for Unity macOS
	# m1decode bundle
	add_library(Mach1DecodeCAPIBundle SHARED "./Mach1DecodeCAPI.cpp" "./Mach1DecodeCore.cpp" "./Mach1Point3DCore.cpp" "./Mach1Point4DCore.cpp")
	set_target_properties(Mach1DecodeCAPIBundle PROPERTIES BUNDLE TRUE)
	set_target_properties(Mach1DecodeCAPIBundle PROPERTIES OUTPUT_NAME "Mach1DecodeCAPI")
	set_target_properties(Mach1DecodeCAPIBundle PROPERTIES SUFFIX ".bundle")
	install(TARGETS Mach1DecodeCAPIBundle DESTINATION lib)
	#m1decodepositional bundle
	add_library(Mach1DecodePositionalCAPIBundle SHARED "./Mach1DecodePositionalCAPI.cpp" "./Mach1DecodeCore.cpp" "./Mach1DecodePositionalCore.cpp" "./Mach1Point3DCore.cpp" "./Mach1Point4DCore.cpp")
	target_include_directories(Mach1DecodePositionalCAPIBundle PRIVATE "./include")
	set_target_properties(Mach1DecodePositionalCAPIBundle PROPERTIES BUNDLE TRUE)
	set_target_properties(Mach1DecodePositionalCAPIBundle PROPERTIES OUTPUT_NAME "Mach1DecodePositionalCAPI")
	set_target_properties(Mach1DecodePositionalCAPIBundle PROPERTIES SUFFIX ".bundle")
	install(TARGETS Mach1DecodePositionalCAPIBundle DESTINATION lib)
	#m1encode bundle
	add_library(Mach1EncodeCAPIBundle SHARED "./Mach1EncodeCAPI.cpp" "./Mach1EncodeCore.cpp")
	set_target_properties(Mach1EncodeCAPIBundle PROPERTIES BUNDLE TRUE)
	set_target_properties(Mach1EncodeCAPIBundle PROPERTIES OUTPUT_NAME "Mach1EncodeCAPI")
	set_target_properties(Mach1EncodeCAPIBundle PROPERTIES SUFFIX ".bundle")
	install(TARGETS Mach1EncodeCAPIBundle DESTINATION lib)
else()
	add_library(Mach1DecodeCAPI SHARED "./Mach1DecodeCAPI.cpp" "./Mach1DecodeCore.cpp" "./Mach1Point3DCore.cpp" "./Mach1Point4DCore.cpp")
	add_library(Mach1DecodePositionalCAPI SHARED "./Mach1DecodePositionalCAPI.cpp" "./Mach1DecodeCAPI.cpp" "./Mach1DecodeCore.cpp" "./Mach1DecodePositionalCore.cpp" "./Mach1Point3DCore.cpp" "./Mach1Point4DCore.cpp")
	target_include_directories(Mach1DecodePositionalCAPI PRIVATE "./include")
	add_library(Mach1EncodeCAPI SHARED "./Mach1EncodeCAPI.cpp" "./Mach1EncodeCore.cpp")
	install(TARGETS Mach1DecodeCAPI DESTINATION lib)
	install(TARGETS Mach1EncodeCAPI DESTINATION lib)
	install(TARGETS Mach1DecodePositionalCAPI DESTINATION lib)
endif()